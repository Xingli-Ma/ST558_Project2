---
title: "Project 2"
author: "Nermin Bibic"
date: "7/11/2021"
output:
  html_document:
    toc: yes
    toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = TRUE, message = FALSE, warning = FALSE, error = TRUE)
```

```{r, echo = FALSE}
library(tidyverse)
library(knitr)
library(caret)
```

## Read Data and Split Into Training & Test Sets

```{r}
# Read and clean data
dayData <- read_csv("day.csv")
dayData <- filter(dayData, weekday == 1)
dayData <- select(dayData, -c(instant, weekday))
dayData$dteday = as.Date(dayData$dteday, format = "%Y-%m-%d")

# Split data to train and test sets
set.seed(1)
dayIndex <- createDataPartition(dayData$cnt, p = 0.7, list = FALSE)
dayTrain <- dayData[mondayIndex, ]
dayTest <- dayData[-mondayIndex, ]

# Convert categorical variables to factors
cols <- c("season", "yr", "mnth", "holiday", "workingday", "weathersit")
dayTrain[cols] <- lapply(dayTrain[cols], factor)
dayTest[cols] <- lapply(dayTest[cols], factor)
```

## Predictive Modeling

### Linear Regression With Main Effects & Interactions

```{r}
lmFit <- train(cnt ~ ., data = dayTrain,
               method = "lm",
               preProcess = c("center", "scale"),
               trControl = trainControl(method = "cv", number = 10))
```

### Random Forest

```{r}
rfFit <- train(cnt ~ ., data = dayTrain,
               method = "rf",
               preProcess = c("center", "scale"),
               trControl = trainControl(method = "cv",
                                        number = 5),
               tuneGrid = data.frame(mtry = 1:9)
               )
```


